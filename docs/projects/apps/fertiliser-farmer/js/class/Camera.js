import { worldWidth, worldHeight, layers } from '../main.js';
export class Camera {
    constructor() {
        this.moved = true;
        this.x = 0;
        this.y = 0;
        this.scale = 1;
        //TODO magic numbers
        this.xOffset = 64;
        this.yOffset = 96;
        this.resized();
    }
    get right() {
        return this.x + this.viewWidth;
    }
    get bottom() {
        return this.y + this.viewHeight;
    }
    get viewWidth() {
        // if (this.scale < 1) return (layers[0].cnv.width + this.xOffset) * this.scale;
        return (layers[0].cnv.width + this.xOffset) * 1 / this.scale;
    }
    get viewHeight() {
        // if (this.scale < 1) return (layers[0].cnv.height + this.yOffset) * this.scale;
        return (layers[0].cnv.height + this.yOffset) * 1 / this.scale;
    }
    //TODO magic numbers
    get hBounds() {
        return ((worldWidth * 64) - this.viewWidth + this.xOffset * 1 / this.scale) * this.scale;
    }
    get vBounds() {
        return ((worldHeight * 16) - this.viewHeight + this.yOffset * 1 / this.scale) * this.scale;
    }
    inView(obj) {
        if (this.scale < 1) {
            return ((obj.x + this.xOffset) * this.scale > this.x && obj.x * this.scale < this.x + this.viewWidth
                && (obj.y + this.yOffset) * this.scale > this.y && obj.y * this.scale < this.y + this.viewHeight);
        }
        else {
            return ((obj.x + this.xOffset) > this.x * 1 / this.scale && (obj.x - this.xOffset * this.scale * 2) < (this.x + this.viewWidth) * 1 / this.scale
                && (obj.y + this.yOffset) > this.y * 1 / this.scale && (obj.y - this.yOffset * this.scale) < (this.y + this.viewHeight) * 1 / this.scale);
        }
    }
    resized() {
        this.move();
    }
    get minX() {
        return this.xOffset / 2 * this.scale;
    }
    get minY() {
        return 16 * this.scale;
    }
    move(xAmt = 0, yAmt = 0) {
        this.moved = true;
        if (this.x + xAmt > this.hBounds) {
            this.x = this.hBounds;
        }
        else if (this.x + xAmt < this.minX) {
            this.x = this.minX;
        }
        else {
            this.x += xAmt;
        }
        if (this.y + yAmt > this.vBounds) {
            this.y = this.vBounds;
        }
        //TODO magic numbers
        else if (this.y + yAmt < this.minY) {
            this.y = this.minY;
        }
        else {
            this.y += yAmt;
        }
    }
    drawObjects(actors) {
        if (!actors[0] || actors[0] == undefined)
            return;
        // NOTE all actors passed to this function must be on the same layer
        actors[0].ctx.save();
        actors[0].ctx.translate(-this.x, -this.y);
        actors[0].ctx.scale(this.scale, this.scale);
        for (let a of actors) {
            a.draw();
        }
        actors[0].ctx.restore();
    }
    touchToWorld(coords) {
        return [(coords[0] + this.x) * this.scale, (coords[1] + this.y) * this.scale];
    }
}

//# sourceMappingURL=data:application/json;charset=utf8;base64,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QUksQ0FBQyxLQUFLLEVBQUUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQTtJQUNqRixDQUFDO0NBRUoiLCJmaWxlIjoiY2xhc3MvQ2FtZXJhLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgd29ybGRXaWR0aCwgd29ybGRIZWlnaHQsIGxheWVycyB9IGZyb20gJy4uL21haW4uanMnO1xuaW1wb3J0IHsgV29ybGRBY3RvciB9IGZyb20gJy4vV29ybGRBY3Rvci5qcyc7XG5cbmV4cG9ydCBjbGFzcyBDYW1lcmEge1xuICAgIG1vdmVkOiBib29sZWFuID0gdHJ1ZTtcbiAgICB4OiBudW1iZXIgPSAwO1xuICAgIHk6IG51bWJlciA9IDA7XG5cbiAgICBzY2FsZTogbnVtYmVyID0gMTtcblxuICAgIC8vVE9ETyBtYWdpYyBudW1iZXJzXG4gICAgeE9mZnNldCA9IDY0O1xuICAgIHlPZmZzZXQgPSA5NjtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLnJlc2l6ZWQoKTtcbiAgICB9XG5cbiAgICBnZXQgcmlnaHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnggKyB0aGlzLnZpZXdXaWR0aDtcbiAgICB9XG5cbiAgICBnZXQgYm90dG9tKCkge1xuICAgICAgICByZXR1cm4gdGhpcy55ICsgdGhpcy52aWV3SGVpZ2h0O1xuICAgIH1cblxuICAgIGdldCB2aWV3V2lkdGgoKSB7XG4gICAgICAgIC8vIGlmICh0aGlzLnNjYWxlIDwgMSkgcmV0dXJuIChsYXllcnNbMF0uY252LndpZHRoICsgdGhpcy54T2Zmc2V0KSAqIHRoaXMuc2NhbGU7XG4gICAgICAgIHJldHVybiAobGF5ZXJzWzBdLmNudi53aWR0aCArIHRoaXMueE9mZnNldCkgKiAxIC8gdGhpcy5zY2FsZTtcbiAgICB9XG5cbiAgICBnZXQgdmlld0hlaWdodCgpIHtcbiAgICAgICAgLy8gaWYgKHRoaXMuc2NhbGUgPCAxKSByZXR1cm4gKGxheWVyc1swXS5jbnYuaGVpZ2h0ICsgdGhpcy55T2Zmc2V0KSAqIHRoaXMuc2NhbGU7XG4gICAgICAgIHJldHVybiAobGF5ZXJzWzBdLmNudi5oZWlnaHQgKyB0aGlzLnlPZmZzZXQpICogMSAvIHRoaXMuc2NhbGU7XG4gICAgfVxuXG4gICAgLy9UT0RPIG1hZ2ljIG51bWJlcnNcblxuICAgIGdldCBoQm91bmRzKCkge1xuICAgICAgICByZXR1cm4gKCh3b3JsZFdpZHRoICogNjQpIC0gdGhpcy52aWV3V2lkdGggKyB0aGlzLnhPZmZzZXQgKiAxIC8gdGhpcy5zY2FsZSkgKiB0aGlzLnNjYWxlO1xuICAgIH1cblxuICAgIGdldCB2Qm91bmRzKCkge1xuICAgICAgICByZXR1cm4gKCh3b3JsZEhlaWdodCAqIDE2KSAtIHRoaXMudmlld0hlaWdodCArIHRoaXMueU9mZnNldCAqIDEgLyB0aGlzLnNjYWxlKSAqIHRoaXMuc2NhbGU7XG4gICAgfVxuXG5cbiAgICBpblZpZXcob2JqKSB7XG4gICAgICAgIGlmICh0aGlzLnNjYWxlIDwgMSkge1xuICAgICAgICAgICAgcmV0dXJuICgob2JqLnggKyB0aGlzLnhPZmZzZXQpICogdGhpcy5zY2FsZSA+IHRoaXMueCAmJiBvYmoueCAqIHRoaXMuc2NhbGUgPCB0aGlzLnggKyB0aGlzLnZpZXdXaWR0aFxuICAgICAgICAgICAgICAgICYmIChvYmoueSArIHRoaXMueU9mZnNldCkgKiB0aGlzLnNjYWxlID4gdGhpcy55ICYmIG9iai55ICogdGhpcy5zY2FsZSA8IHRoaXMueSArIHRoaXMudmlld0hlaWdodCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gKChvYmoueCArIHRoaXMueE9mZnNldCkgPiB0aGlzLnggKiAxIC8gdGhpcy5zY2FsZSAmJiAob2JqLnggLSB0aGlzLnhPZmZzZXQgKiB0aGlzLnNjYWxlICogMikgPCAodGhpcy54ICsgdGhpcy52aWV3V2lkdGgpICogMSAvIHRoaXMuc2NhbGVcbiAgICAgICAgICAgICAgICAmJiAob2JqLnkgKyB0aGlzLnlPZmZzZXQpID4gdGhpcy55ICogMSAvIHRoaXMuc2NhbGUgJiYgKG9iai55IC0gdGhpcy55T2Zmc2V0ICogdGhpcy5zY2FsZSkgPCAodGhpcy55ICsgdGhpcy52aWV3SGVpZ2h0KSAqIDEgLyB0aGlzLnNjYWxlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJlc2l6ZWQoKSB7XG4gICAgICAgIHRoaXMubW92ZSgpO1xuICAgIH1cblxuICAgIGdldCBtaW5YKCkge1xuICAgICAgICByZXR1cm4gdGhpcy54T2Zmc2V0IC8gMiAqIHRoaXMuc2NhbGU7XG4gICAgfVxuXG4gICAgZ2V0IG1pblkoKSB7XG4gICAgICAgIHJldHVybiAxNiAqIHRoaXMuc2NhbGU7XG4gICAgfVxuXG4gICAgbW92ZSh4QW10ID0gMCwgeUFtdCA9IDApIHtcbiAgICAgICAgdGhpcy5tb3ZlZCA9IHRydWU7XG4gICAgICAgIGlmICh0aGlzLnggKyB4QW10ID4gdGhpcy5oQm91bmRzKSB7XG4gICAgICAgICAgICB0aGlzLnggPSB0aGlzLmhCb3VuZHM7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy54ICsgeEFtdCA8IHRoaXMubWluWCkge1xuICAgICAgICAgICAgdGhpcy54ID0gdGhpcy5taW5YO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy54ICs9IHhBbXQ7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy55ICsgeUFtdCA+IHRoaXMudkJvdW5kcykge1xuICAgICAgICAgICAgdGhpcy55ID0gdGhpcy52Qm91bmRzO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9UT0RPIG1hZ2ljIG51bWJlcnNcbiAgICAgICAgZWxzZSBpZiAodGhpcy55ICsgeUFtdCA8IHRoaXMubWluWSkge1xuICAgICAgICAgICAgdGhpcy55ID0gdGhpcy5taW5ZO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy55ICs9IHlBbXQ7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBkcmF3T2JqZWN0cyhhY3RvcnM6IFdvcmxkQWN0b3JbXSkge1xuICAgICAgICBpZiAoIWFjdG9yc1swXSB8fCBhY3RvcnNbMF0gPT0gdW5kZWZpbmVkKSByZXR1cm47XG4gICAgICAgIC8vIE5PVEUgYWxsIGFjdG9ycyBwYXNzZWQgdG8gdGhpcyBmdW5jdGlvbiBtdXN0IGJlIG9uIHRoZSBzYW1lIGxheWVyXG4gICAgICAgIGFjdG9yc1swXS5jdHguc2F2ZSgpO1xuICAgICAgICBhY3RvcnNbMF0uY3R4LnRyYW5zbGF0ZSgtdGhpcy54LCAtdGhpcy55KTtcbiAgICAgICAgYWN0b3JzWzBdLmN0eC5zY2FsZSh0aGlzLnNjYWxlLCB0aGlzLnNjYWxlKTtcbiAgICAgICAgZm9yIChsZXQgYSBvZiBhY3RvcnMpIHtcbiAgICAgICAgICAgIGEuZHJhdygpO1xuICAgICAgICB9XG4gICAgICAgIGFjdG9yc1swXS5jdHgucmVzdG9yZSgpO1xuICAgIH1cblxuICAgIHRvdWNoVG9Xb3JsZChjb29yZHMpIHtcbiAgICAgICAgcmV0dXJuIFsoY29vcmRzWzBdICsgdGhpcy54KSAqIHRoaXMuc2NhbGUsIChjb29yZHNbMV0gKyB0aGlzLnkpICogdGhpcy5zY2FsZV1cbiAgICB9XG5cbn1cbiJdfQ==
