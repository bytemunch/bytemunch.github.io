const intersecting = (v1x1, v1y1, v1x2, v1y2, v2x1, v2y1, v2x2, v2y2) => {
    // Lifted from https://stackoverflow.com/users/15809/mecki
    // at https://stackoverflow.com/questions/217578/how-can-i-determine-whether-a-2d-point-is-within-a-polygon
    let d1, d2;
    let a1, a2, b1, b2, c1, c2;
    // Convert vector 1 to a line (line 1) of infinite length.
    // We want the line in linear equation standard form: A*x + B*y + C = 0
    // See: http://en.wikipedia.org/wiki/Linear_equation
    a1 = v1y2 - v1y1;
    b1 = v1x1 - v1x2;
    c1 = (v1x2 * v1y1) - (v1x1 * v1y2);
    // Every point (x,y), that solves the equation above, is on the line,
    // every point that does not solve it, is not. The equation will have a
    // positive result if it is on one side of the line and a negative one 
    // if is on the other side of it. We insert (x1,y1) and (x2,y2) of vector
    // 2 into the equation above.
    d1 = (a1 * v2x1) + (b1 * v2y1) + c1;
    d2 = (a1 * v2x2) + (b1 * v2y2) + c1;
    // If d1 and d2 both have the same sign, they are both on the same side
    // of our line 1 and in that case no intersection is possible. Careful, 
    // 0 is a special case, that's why we don't test ">=" and "<=", 
    // but "<" and ">".
    if (d1 > 0 && d2 > 0)
        return false;
    if (d1 < 0 && d2 < 0)
        return false;
    // The fact that vector 2 intersected the infinite line 1 above doesn't 
    // mean it also intersects the vector 1. Vector 1 is only a subset of that
    // infinite line 1, so it may have intersected that line before the vector
    // started or after it ended. To know for sure, we have to repeat the
    // the same test the other way round. We start by calculating the 
    // infinite line 2 in linear equation standard form.
    a2 = v2y2 - v2y1;
    b2 = v2x1 - v2x2;
    c2 = (v2x2 * v2y1) - (v2x1 * v2y2);
    // Calculate d1 and d2 again, this time using points of vector 1.
    d1 = (a2 * v1x1) + (b2 * v1y1) + c2;
    d2 = (a2 * v1x2) + (b2 * v1y2) + c2;
    // Again, if both have the same sign (and neither one is 0),
    // no intersection is possible.
    if (d1 > 0 && d2 > 0)
        return false;
    if (d1 < 0 && d2 < 0)
        return false;
    // If we get here, only two possibilities are left. Either the two
    // vectors intersect in exactly one point or they are collinear, which
    // means they intersect in any number of points from zero to infinite.
    if ((a1 * b2) - (a2 * b1) == 0.0)
        return false;
    // If they are not collinear, they must intersect in exactly one point.
    return true;
};
export const pointInPolygon = (polyPoints, testPoint) => {
    let minX = Math.min(...polyPoints.map(v => v[0]));
    let minY = Math.min(...polyPoints.map(v => v[1]));
    let e = 20;
    let rayStart = [minX - e, minY - e];
    let rayEnd = testPoint;
    let dist = Math.sqrt(((rayStart[0] - rayEnd[0]) ** 2 + (rayStart[1] - rayEnd[1]) ** 2));
    // Broad phase
    if (dist > 100)
        return false;
    // Test intersections with lines
    let intersections = 0;
    for (let i = 0; i < polyPoints.length; i++) {
        let j = i + 1;
        if (i == polyPoints.length - 1)
            j = 0;
        if (intersecting(rayStart[0], rayStart[1], rayEnd[0], rayEnd[1], polyPoints[i][0], polyPoints[i][1], polyPoints[j][0], polyPoints[j][1])) {
            intersections++;
        }
    }
    return (intersections % 2 != 0);
};

//# sourceMappingURL=data:application/json;charset=utf8;base64,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QUFDLENBQUMsQ0FBQyxFQUMzRCxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRTtZQUN6RSxhQUFhLEVBQUUsQ0FBQztTQUNuQjtLQUNKO0lBRUQsT0FBTyxDQUFDLGFBQWEsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7QUFDcEMsQ0FBQyxDQUFBIiwiZmlsZSI6ImZ1bmN0aW9ucy9jb2xsaXNpb24uanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBpbnRlcnNlY3RpbmcgPSAoXG4gICAgdjF4MSwgdjF5MSwgdjF4MiwgdjF5MixcbiAgICB2MngxLCB2MnkxLCB2MngyLCB2MnkyXG4pID0+IHtcbiAgICAvLyBMaWZ0ZWQgZnJvbSBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3VzZXJzLzE1ODA5L21lY2tpXG4gICAgLy8gYXQgaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMjE3NTc4L2hvdy1jYW4taS1kZXRlcm1pbmUtd2hldGhlci1hLTJkLXBvaW50LWlzLXdpdGhpbi1hLXBvbHlnb25cblxuICAgIGxldCBkMSwgZDI7XG4gICAgbGV0IGExLCBhMiwgYjEsIGIyLCBjMSwgYzI7XG5cbiAgICAvLyBDb252ZXJ0IHZlY3RvciAxIHRvIGEgbGluZSAobGluZSAxKSBvZiBpbmZpbml0ZSBsZW5ndGguXG4gICAgLy8gV2Ugd2FudCB0aGUgbGluZSBpbiBsaW5lYXIgZXF1YXRpb24gc3RhbmRhcmQgZm9ybTogQSp4ICsgQip5ICsgQyA9IDBcbiAgICAvLyBTZWU6IGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTGluZWFyX2VxdWF0aW9uXG4gICAgYTEgPSB2MXkyIC0gdjF5MTtcbiAgICBiMSA9IHYxeDEgLSB2MXgyO1xuICAgIGMxID0gKHYxeDIgKiB2MXkxKSAtICh2MXgxICogdjF5Mik7XG5cbiAgICAvLyBFdmVyeSBwb2ludCAoeCx5KSwgdGhhdCBzb2x2ZXMgdGhlIGVxdWF0aW9uIGFib3ZlLCBpcyBvbiB0aGUgbGluZSxcbiAgICAvLyBldmVyeSBwb2ludCB0aGF0IGRvZXMgbm90IHNvbHZlIGl0LCBpcyBub3QuIFRoZSBlcXVhdGlvbiB3aWxsIGhhdmUgYVxuICAgIC8vIHBvc2l0aXZlIHJlc3VsdCBpZiBpdCBpcyBvbiBvbmUgc2lkZSBvZiB0aGUgbGluZSBhbmQgYSBuZWdhdGl2ZSBvbmUgXG4gICAgLy8gaWYgaXMgb24gdGhlIG90aGVyIHNpZGUgb2YgaXQuIFdlIGluc2VydCAoeDEseTEpIGFuZCAoeDIseTIpIG9mIHZlY3RvclxuICAgIC8vIDIgaW50byB0aGUgZXF1YXRpb24gYWJvdmUuXG4gICAgZDEgPSAoYTEgKiB2MngxKSArIChiMSAqIHYyeTEpICsgYzE7XG4gICAgZDIgPSAoYTEgKiB2MngyKSArIChiMSAqIHYyeTIpICsgYzE7XG5cbiAgICAvLyBJZiBkMSBhbmQgZDIgYm90aCBoYXZlIHRoZSBzYW1lIHNpZ24sIHRoZXkgYXJlIGJvdGggb24gdGhlIHNhbWUgc2lkZVxuICAgIC8vIG9mIG91ciBsaW5lIDEgYW5kIGluIHRoYXQgY2FzZSBubyBpbnRlcnNlY3Rpb24gaXMgcG9zc2libGUuIENhcmVmdWwsIFxuICAgIC8vIDAgaXMgYSBzcGVjaWFsIGNhc2UsIHRoYXQncyB3aHkgd2UgZG9uJ3QgdGVzdCBcIj49XCIgYW5kIFwiPD1cIiwgXG4gICAgLy8gYnV0IFwiPFwiIGFuZCBcIj5cIi5cbiAgICBpZiAoZDEgPiAwICYmIGQyID4gMCkgcmV0dXJuIGZhbHNlO1xuICAgIGlmIChkMSA8IDAgJiYgZDIgPCAwKSByZXR1cm4gZmFsc2U7XG5cbiAgICAvLyBUaGUgZmFjdCB0aGF0IHZlY3RvciAyIGludGVyc2VjdGVkIHRoZSBpbmZpbml0ZSBsaW5lIDEgYWJvdmUgZG9lc24ndCBcbiAgICAvLyBtZWFuIGl0IGFsc28gaW50ZXJzZWN0cyB0aGUgdmVjdG9yIDEuIFZlY3RvciAxIGlzIG9ubHkgYSBzdWJzZXQgb2YgdGhhdFxuICAgIC8vIGluZmluaXRlIGxpbmUgMSwgc28gaXQgbWF5IGhhdmUgaW50ZXJzZWN0ZWQgdGhhdCBsaW5lIGJlZm9yZSB0aGUgdmVjdG9yXG4gICAgLy8gc3RhcnRlZCBvciBhZnRlciBpdCBlbmRlZC4gVG8ga25vdyBmb3Igc3VyZSwgd2UgaGF2ZSB0byByZXBlYXQgdGhlXG4gICAgLy8gdGhlIHNhbWUgdGVzdCB0aGUgb3RoZXIgd2F5IHJvdW5kLiBXZSBzdGFydCBieSBjYWxjdWxhdGluZyB0aGUgXG4gICAgLy8gaW5maW5pdGUgbGluZSAyIGluIGxpbmVhciBlcXVhdGlvbiBzdGFuZGFyZCBmb3JtLlxuICAgIGEyID0gdjJ5MiAtIHYyeTE7XG4gICAgYjIgPSB2MngxIC0gdjJ4MjtcbiAgICBjMiA9ICh2MngyICogdjJ5MSkgLSAodjJ4MSAqIHYyeTIpO1xuXG4gICAgLy8gQ2FsY3VsYXRlIGQxIGFuZCBkMiBhZ2FpbiwgdGhpcyB0aW1lIHVzaW5nIHBvaW50cyBvZiB2ZWN0b3IgMS5cbiAgICBkMSA9IChhMiAqIHYxeDEpICsgKGIyICogdjF5MSkgKyBjMjtcbiAgICBkMiA9IChhMiAqIHYxeDIpICsgKGIyICogdjF5MikgKyBjMjtcblxuICAgIC8vIEFnYWluLCBpZiBib3RoIGhhdmUgdGhlIHNhbWUgc2lnbiAoYW5kIG5laXRoZXIgb25lIGlzIDApLFxuICAgIC8vIG5vIGludGVyc2VjdGlvbiBpcyBwb3NzaWJsZS5cbiAgICBpZiAoZDEgPiAwICYmIGQyID4gMCkgcmV0dXJuIGZhbHNlO1xuICAgIGlmIChkMSA8IDAgJiYgZDIgPCAwKSByZXR1cm4gZmFsc2U7XG5cbiAgICAvLyBJZiB3ZSBnZXQgaGVyZSwgb25seSB0d28gcG9zc2liaWxpdGllcyBhcmUgbGVmdC4gRWl0aGVyIHRoZSB0d29cbiAgICAvLyB2ZWN0b3JzIGludGVyc2VjdCBpbiBleGFjdGx5IG9uZSBwb2ludCBvciB0aGV5IGFyZSBjb2xsaW5lYXIsIHdoaWNoXG4gICAgLy8gbWVhbnMgdGhleSBpbnRlcnNlY3QgaW4gYW55IG51bWJlciBvZiBwb2ludHMgZnJvbSB6ZXJvIHRvIGluZmluaXRlLlxuICAgIGlmICgoYTEgKiBiMikgLSAoYTIgKiBiMSkgPT0gMC4wKSByZXR1cm4gZmFsc2U7XG5cbiAgICAvLyBJZiB0aGV5IGFyZSBub3QgY29sbGluZWFyLCB0aGV5IG11c3QgaW50ZXJzZWN0IGluIGV4YWN0bHkgb25lIHBvaW50LlxuICAgIHJldHVybiB0cnVlO1xufVxuXG5leHBvcnQgY29uc3QgcG9pbnRJblBvbHlnb24gPSAocG9seVBvaW50czpudW1iZXJbXVtdLCB0ZXN0UG9pbnQ6bnVtYmVyW10pID0+IHtcbiAgICBsZXQgbWluWCA9IE1hdGgubWluKC4uLnBvbHlQb2ludHMubWFwKHY9PnZbMF0pKTtcbiAgICBsZXQgbWluWSA9IE1hdGgubWluKC4uLnBvbHlQb2ludHMubWFwKHY9PnZbMV0pKTtcblxuICAgIGxldCBlID0gMjA7XG5cbiAgICBsZXQgcmF5U3RhcnQgPSBbbWluWC1lLCBtaW5ZLWVdO1xuICAgIGxldCByYXlFbmQgPSB0ZXN0UG9pbnQ7XG5cbiAgICBsZXQgZGlzdCA9IE1hdGguc3FydCgoKHJheVN0YXJ0WzBdLXJheUVuZFswXSkqKjIgKyAocmF5U3RhcnRbMV0tcmF5RW5kWzFdKSoqMikpO1xuXG4gICAgLy8gQnJvYWQgcGhhc2VcbiAgICBpZiAoZGlzdCA+IDEwMCkgcmV0dXJuIGZhbHNlO1xuXG4gICAgLy8gVGVzdCBpbnRlcnNlY3Rpb25zIHdpdGggbGluZXNcbiAgICBsZXQgaW50ZXJzZWN0aW9ucyA9IDA7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb2x5UG9pbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGxldCBqID0gaSArIDE7XG4gICAgICAgIGlmIChpID09IHBvbHlQb2ludHMubGVuZ3RoIC0gMSkgaiA9IDA7XG5cbiAgICAgICAgaWYgKGludGVyc2VjdGluZyhyYXlTdGFydFswXSwgcmF5U3RhcnRbMV0sIHJheUVuZFswXSwgcmF5RW5kWzFdLFxuICAgICAgICAgICAgcG9seVBvaW50c1tpXVswXSwgcG9seVBvaW50c1tpXVsxXSwgcG9seVBvaW50c1tqXVswXSwgcG9seVBvaW50c1tqXVsxXSkpIHtcbiAgICAgICAgICAgIGludGVyc2VjdGlvbnMrKztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiAoaW50ZXJzZWN0aW9ucyAlIDIgIT0gMCk7XG59Il19
